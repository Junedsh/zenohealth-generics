<script>
document.addEventListener("DOMContentLoaded", function() {
  const quizSubmitBtn = document.getElementById("quizSubmitBtn");
  const quizResult = document.getElementById("quizResult");

  quizSubmitBtn.addEventListener("click", function() {
    const quizForm = document.getElementById("quizForm");

    const answers = {
      q1: quizForm.q1.value,
      q2: quizForm.q2.value,
      q3: quizForm.q3.value,
      q4: quizForm.q4.value
    };

    if (answers.q1 === "80" && answers.q2 === "Yes" && answers.q3 === "Money" && answers.q4 === "ZenoHealth") {
      quizResult.innerHTML = `
        <p>üéâ Congratulations! You answered all correctly.</p>
        <p>Please enter your mobile number:</p>
        <input type="tel" id="mobileInput" placeholder="Enter 10-digit mobile">
        <button id="getCouponBtn" type="button">Get My Coupon</button>
      `;
      quizResult.style.display = "block";

      // Add the new event listener for the "Get My Coupon" button here
      const getCouponBtn = document.getElementById("getCouponBtn");
      getCouponBtn.addEventListener("click", function() {
        const mobileInput = document.getElementById("mobileInput");
        const mobileNumber = mobileInput.value;

        // The URL of your deployed Google App Script
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwUl0SDKOtX72u8ZkIUuswCtns4YkURKWdWE29RFGryfqzGSRESW3qJfRXoBErkGyaewg/exec';

        // Check if the mobile number is valid (optional, but good practice)
        if (mobileNumber.length === 10 && !isNaN(mobileNumber)) {
          fetch(`${scriptURL}?mobile=${mobileNumber}`)
            .then(response => response.json())
            .then(data => {
              // Display the result from the App Script
              if (data.status === 'success') {
                quizResult.innerHTML = `<p>‚úÖ Coupon sent to your number: ${mobileNumber}</p>`;
              } else {
                quizResult.innerHTML = `<p>‚ö†Ô∏è Error: ${data.message}</p>`;
              }
            })
            .catch(error => {
              console.error('Error:', error);
              quizResult.innerHTML = `<p>‚ö†Ô∏è An error occurred. Please try again later.</p>`;
            });
        } else {
          alert("Please enter a valid 10-digit mobile number.");
        }
      });

    } else {
      quizResult.innerHTML = `<p>‚ùå Oops! Some answers are wrong. Try again.</p>`;
      quizResult.style.display = "block";
    }
  });
});
</script>
